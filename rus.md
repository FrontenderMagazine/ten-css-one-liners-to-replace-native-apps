# Десять строчек на CSS, которые помогут отказаться от нативных приложений

> Хокон Виум Ли (Håkon Wium Lie) является отцом CSS, главным инженером в Opera и
одним из первых приверженцев веб-стандартов. Ранее в этом году мы опубликовали
его статью [«CSS Regions, возможно, вредны для веба»][1]. Когда Хокон Виум
говорит — мы слушаем, независимо от того согласны мы с ним или нет.
Сегодня Хокон представляет CSS Врезки (CSS Figures) и приводит примеры
их использования.

С появлением планшетов и мобильных устройств нам пришлось пересмотреть свой
подход к веб-дизайну. Полосы прокрутки, управляемые с помощью мыши, должны
быть заменены жестами пролистывания, а врезки должны свободно плавать в
мультиколоночной раскладке. Может ли это всё быть сделано с помощью CSS?

Перелистываемые страницы, плавающие врезки и многоколоночная разметка
уже сегодня активно используются на мобильных устройствах. В качестве примеров
можно привести [журнал Flipboard][2], [интерактивную книгу «Наш выбор»][3] или
[приложение Paper от Facebook][4]. Они все являются нативными приложениями. Если
мы хотим, чтобы веб восторжествовал на этих устройствах, (а мы хотим),
жизненно важно предоставить веб-разработчикам возможность создавать страницы
с таким представлением используя веб-стандарты. Если веб-стандарты не могут
 решить эту задачу, разработчикам ничего не остаётся, кроме как использовать
 возможности нативных приложений.

Последние несколько лет я работал над редакцией двух спецификаций, которые
в сочетании друг с другом дают такие функциональные возможности: [
Многоколоночная разметка на CSS (CSS Multi-column Layout)][5] и [CSS Врезки
(CSS Figures)][6].
Думаю, что они играют важную роль в том, чтобы веб оставался привлекательным
 окружением для поставщиков интернет-контента.

 В этой статье я продемонстрирую как просто писать CSS-код на основе этих двух
 спецификаций. Я сделаю это с помощью 10 примеров кода, длиной в
 строку. Настоящие таблицы стилей будут немного длиннее, но, тем не менее,
 компактными, простыми для чтения и пригодными для переиспользования.
 Вот несколько скриншотов, чтобы дать вам визуальное представление о том, к
 чему мы стремимся:

![скриншот1][Три варианта представления веб-страницы с разным количеством колонок для экранов разных размеров]

## Создание страницы

Для начала я возьму статью с заголовком, текстом и парой
изображений. В обычных браузерах статья будет отображаться в виде одной
колонки с полосой прокрутки с правой стороны. Используя CSS Multi-column Layout
вы можете задать статье отображение в виде двух колонок вместо одной:

    article { columns: 2 }

Это достаточно могущественная строчка кода, однако мы можем сделать её лучше;
 можно сделать так, чтобы количество колонок зависело от доступного
 пространства, чтобы на узком экране отображалась одна колонка, на более
 широком — две и т.д. Всё, что для этого нужно сделать — это указать, что
 оптимальной длиной строки является 15em, и количество колонок будет
 рассчитываться само собой:

    article { columns: 15em }

В этом месте CSS-код для меня превращается в поэзию: одна короткая строчка кода
подстраивает текст под узенький телефон и под широчайший экран телевизора,
 под мелкоформатную печать и под формат для читателей с дефектами зрения.
 Никакого JavaScript, никаких медиа-запросов или других сложных штук. Всего лишь
одна изумительно отзывчивая строчка кода. Именно эта строчка использовалась для
демонстрации эффекта, представленного на скриншотах выше. К тому же она
 работает в современных браузерах (что пока нельзя сказать про следующие
примеры).

На скриншотах выше вы видите пролистываемое представление, а не
прокручиваемое.
Это легко делается с помощью:

    article { overflow: paged-x }

Код, приведённый выше, указывает, что статья должна быть разбита на страницы,
расположенные по оси x (слева направо).
Браузеры, поддерживающие это свойство, должны предоставлять возможность
навигации по страницам. Например, пользователь может перейти на следующую
страницу, используя свайп или наклонив устройство. Также будет уместным
 визуальное указание текущего положения в документе, вроде того, что
 показывает полоса прокрутки в прокручиваемых окружениях . На планшете или
 мобильном телефоне перемещаться между страницами или документами
с помощью свайпа намного проще чем с помощью прокрутки.

## Изображения

Добавление изображений в статью несколько повышает сложность разметки.
Текстовые строки могут быть легко распределены между несколькими
колонками, однако если врезки идут вперемешку с текстом, результат может
получиться неаккуратным.
Так как изображение не делится на части, мы получим неиспользованное пустое
пространство, если оно окажется в месте перехода на следующую колонку.
Чтобы этого избежать, в традиционной печатной раскладке изображения
помещаются в нижнюю или верхнюю часть колонок, тем самым позволяя тексту
заполнить пустое пространство. С помощью CSS это можно сделать добавив для
свойства `float` значения `top` и `bottom`. Например:

    img { float: bottom }

Синеватые картинки с гаванью на скриншотах выше "плавают" внизу страницы
благодаря именно этой строчке кода. CSS используется для того, что не может
 быть сделано помощью HTML; невозможно знать заранее сколько текстового
 контента поместится на экране до того, как он будет отформатирован.
 Следовательно, разработчик не может предугадать где нужно разместить
 изображение в исходном коде, чтобы в итоге оно отображалось внизу колонки.
 Возможность задавать размещение фигур по верхнему
и нижнему краю через `top` and `bottom` (в дополнение к уже существующим `left` и
`right`) — это естественное расширение значений свойства `float` .

## Охват нескольких колонок

Ещё один трюк, одолженный у традиционной печатной разметки, — это когда
врезка охватывает несколько колонок. Взгляните на эту вырезку из газеты:

![скриншот2][Вырезка из газеты, на которой можно увидеть текст, разделённый на четыре колонки, и изображения в нижнем левом, нижнем правом и верхнем правом углу]

*Использовано с разрешения Bristol Observer*

В этой статье изображение слева занимает две колонки и размещается по
нижней границе колонок. Код, с помощью которого это можно сделать в CSS,
очень простой:

    figure { float: bottom; column-span: 2; }

HTML5-элемент `figure` прекрасно подходит для размещения в нём изображения и
подписи под ним:

    <figure>
        <img src=cats.jpg>
        <figcaption>Isabel loves the fluffy felines</figcaption>
    </figure>

В газетной статье также есть врезка, которая охватывает три колонки и
располагается в верхнем правом углу. В предыдущей версии спецификации
CSS-врезок это достигалось с помощью `float: top-corner`. Однако после
обсуждения с разработчиками стало ясно, что контент может быть расположен не
только по углам, поэтому в спецификацию были добавлены новые свойства,
с помощью которых контент может быть [смещён][7] до следующей колонки,
страницы или строки.

## Смещённые врезки

Чтобы задать фотографии с котом положение в верхней части последней колонки
 и при этом захватить три колонки по ширине, можно использовать
следующий код:

    figure { float: top; float-defer-column: last; column-span: 3 }

Этот код, может быть, менее понятен (в сравнении с отвергнутым `top-corner`),
однако он открывает ряд возможностей. Например, можно расположить элемент во
второй колонке:

    .byline { float: top; float-defer-column: 1 }

Код выше смещает строку с указанием автора, «By Collette Jackson», на одну
 колонку. Это значит, что если строка с именем автора в обычном случае
 должна была располагаться в первой колонке, вместо этого она будет
 расположена во второй (как вы видите в вырезке из газеты). Чтобы это
 заработало, в HTML-коде необходимо разместить строку с именем автора
 в начале статьи. Например вот так:

    <article>
      <h1>New rescue center pampers Persians</h1>
      <p class=byline>By Collette Jackson</p>
      ...
    </article>

## Смещённые рекламные объявления

Рекламные объявления — это ещё один тип контента, который лучше всего
прописывать в начале исходного кода и смещать для последующего вывода
на страницу. Вот пример HTML-кода:

    <article>
      <aside id=ad1 src=ad1.png>
      <aside id=ad2 src=ad2.png>
      <h1>New rescue center pampers Persians</h1>
    </article>

А вот соответствующий CSS-код, по одной строчке для каждого рекламного
объявления:

    #ad1 { float-defer-page: 1 }
    #ad2 { float-defer-page: 3 }

В результате применения этого кода, реклама будет отображаться на второй и
четвёртой странице. Опять таки, этого нельзя достичь, просто разместив
рекламные объявления внутри текста, так как на разных устройствах переносы
страниц будут в разных местах.

Думаю и читателям, и рекламодателям понравится веб, более ориентированный на
постраничное представление. В бумажных изданиях реклама никому особо не
мешает.
Точно так же, я думаю, реклама на пролистываемых носителях
информации будет менее навязчивой, чем на носителях с прокруткой.

## Смещённые цитаты

Последний пример контента, который может быть смещён — это цитаты.
Цитата — это выдержка из статьи, представленная большим шрифтом в каком-то определённом месте страницы. В этом примере цитата находится посередине второй колонки:

![скриншот3][Изображение врезки в печатной газете]

Вот код, которым это можно сделать в CSS:

    .pullquote#first { float-defer-line: 50% }

Другие типы контента также можно позиционировать с помощью смещения.
Например, фотографию можно расположить над сгибом газеты,
отступив на сколько строк. Это будет работать и для сгибаемых
экранов будущего.

Цитаты — это довольно интересное явление, которое заслуживает дополнительного
обсуждения. У цитат есть две функции. Во-первых, они представляют собой
некий интересный отрывок текста для привлечения внимания. Во-вторых,
визуальное представление статьи становится более разнообразным, когда
сплошной поток текста прерывается за счёт цитаты, набранной крупным шрифтом.
 Обычно размещается не более одной цитаты на страницу. На бумаге, когда
 известно сколько страниц займёт статья, легко предусмотреть нужное количество
 цитат. В вебе контент по-разному подстраивается под разные типы экранов;
 некоторые читатели увидят много маленьких страниц, другие — небольшое
 количество крупных.

 Чтобы убедиться, что  цитат хватит на каждую страницу, разработчикам нужно
 приготовить их с избытком. Лишние цитаты не должны отображаться в конце
 статьи (что было бы естественным для веб-браузера), они должны быть
полностью скрыты, потому, что их содержимое в любом случае представлено
в основном тексте статьи.
Это можно сделать с помощью одной строки:

    .pullquote { float-policy: drop-tail }

В этом коде говорится: если врезка находится в хвостовой части статьи, её не
 нужно показывать. Ту же строчку кода можно использовать для лишних
 фотографий в конце статьи; в большинстве случаев дизайнеры стремятся
 разместить по  одному изображению на каждой странице, но не больше.

## Упражнения для закрепления материала

Усердный читатель, возможно, сочтёт нужным ознакомиться со спецификациями
[по многоколоночной разметке на CSS][8] и [CSS-фигурам][9]. В них описано больше
примеров использования и возможностей управления, помогающих разработчикам
задать идеальное поведение врезок на веб-страницах.

Если вы хотите поиграть с CSS-врезками, проще всего будет скачать
[Opera 12.16][10] и открыть в нём [этот документ][11], который использовался при
создании скриншотов для Иллюстрации 1. Исходя из моего опыта разработки,
спецификации уже, скорее всего, изменены и не все примеры кода, представленные в
этой статье, будут работать. Также [Prince][12] и [AntennaHouse][13] частично
поддерживают CSS-врезки — это сервисы для массового форматирования [PDF документов][14].

Я с удовольствием выслушаю тех, кому понравился подход, описанный в этой статье,
и тех, кому он не понравился. Вы хотели бы чтобы это было добавлено в браузеры?
Сообщите мне ниже или обратитесь с соответствующей просьбой к разработчикам
своего любимого браузера ([Firefox][15], [Chrome][16], [Opera][17], [IE][18]).
Если вам не нравятся представленные возможности, какой код вы бы использовали для решения задач, описанных в статье?

Страницы и колонки являются базовыми строительными блоками в типографике с тех
пор, как римляне начали нарезать свитки на страницы. Но браузеры должны их
поддерживать не поэтому. А потому, что они помогают нам сделать лучше и удобнее пользование мобильными устройствами.

[1]: http://alistapart.com/blog/post/css-regions-considered-harmful
[2]: https://flipboard.com/
[3]: http://www.ted.com/talks/mike_matas
[4]: https://www.facebook.com/paper
[5]: http://www.w3.org/TR/css3-multicol/
[6]: http://figures.spec.whatwg.org/
[7]: http://figures.spec.whatwg.org/#deferring-page-floats
[8]: http://www.w3.org/TR/css3-multicol/
[9]: http://figures.spec.whatwg.org/
[10]: http://www.opera.com/download/guide/?ver=12.16
[11]: http://www.wiumlie.no/2014/css-figures/koster/prefix.html
[12]: http://www.princexml.com/
[13]: http://www.antennahouse.com/
[14]: http://www.wiumlie.no/2014/css-figures/koster/prefix-pr.pdf
[15]: https://input.mozilla.org/en-US/feedback
[16]: https://productforums.google.com/forum/?rd=1#!categories/chrome/give-feature-feedback-and-suggestions
[17]: http://forums.opera.com/categories/en-opera-next-and-opera-developer
[18]: https://connect.microsoft.com/IE/feedback/

[Три варианта представления веб-страницы с разным количеством колонок для экранов разных размеров]: img/koster.jpg
[Вырезка из газеты, на которой можно увидеть текст, разделённый на четыре колонки, и изображения в нижнем левом, нижнем правом и верхнем правом углу]: img/newspaper.jpg
[Изображение врезки в печатной газете]: img/pullquote.jpg